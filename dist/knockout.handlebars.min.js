/*
* knockout-handlebars.js v0.1.0 - handlebars and more syntax sugar for knockout.js
* https://github.com/sergeyt/knockout-handlebars
* Licensed under MIT (https://github.com/sergeyt/knockout-handlebars/blob/master/LICENSE)
*/

!function(){function parseInterpolationMarkup(textToParse,outerTextCallback,expressionCallback){function innerParse(text){var innerMatch=text.match(/^([\s\S]*?)}}([\s\S]*)\{\{([\s\S]*)$/);innerMatch?(expressionCallback(innerMatch[1]),outerParse(innerMatch[2]),expressionCallback(innerMatch[3])):expressionCallback(text)}function outerParse(text){var outerMatch=text.match(/^([\s\S]*?)\{\{([\s\S]*)}}([\s\S]*)$/);outerMatch?(outerTextCallback(outerMatch[1]),innerParse(outerMatch[2]),outerTextCallback(outerMatch[3])):outerTextCallback(text)}outerParse(textToParse)}function interpolateMarkup(node){function addTextNode(text){text&&nodes.push(document.createTextNode(text))}function wrapExpr(expressionText){expressionText&&nodes.push(create_expression_node(expressionText))}if(3===node.nodeType&&node.nodeValue&&-1!==node.nodeValue.indexOf("{{")){var nodes=[];if(parseInterpolationMarkup(node.nodeValue,addTextNode,wrapExpr),nodes.length){if(node.parentNode){for(var i=0;i<nodes.length;i++)node.parentNode.insertBefore(nodes[i],node);node.parentNode.removeChild(node)}return nodes}}}function process_attrs(node){if(1===node.nodeType&&node.attributes&&node.attributes.length){var attr=node.attributes["data-bind"],dataBind=attr?attr.value:"",attrBindings=get_attr_bindings(node).join(", ");dataBind&&attrBindings&&(dataBind+=", "),dataBind+=attrBindings,dataBind&&node.setAttribute("data-bind",dataBind)}}function commentFn(keyword,prefix){return function(expr){return expr=expr.substr(prefix.length).trim(),document.createComment(" ko "+keyword+": "+expr+" ")}}function create_expression_node(expr){var prefix,fn,i=expr.indexOf(" ");if(i>=0&&(prefix=expr.substr(0,i),fn=expr_map[prefix]))return fn(expr);if(prefix=expr.charAt(0),fn=expr_map[prefix])return fn(expr);var span=document.createElement("span");return span.setAttribute("data-bind","text: "+expr),span}function get_attr_bindings(node){function process_attr(attribute){function addText(text){text&&parts.push('"'+text.replace(/"/g,'\\"')+'"')}function addExpr(expressionText){expressionText&&parts.push(expressionText)}var parts=[];if(parseInterpolationMarkup(attribute.value,addText,addExpr),!parts.length)return!1;var binding=parts.join("+"),name=bindingMap[attribute.name]||"attr";return"attr"==name?attrBinding.push(attribute.name+":"+binding):bindings.push(name+":"+binding),!0}for(var attrBinding=[],bindings=[],i=node.attributes.length-1;i>=0;i--){var attr=node.attributes[i];if("data-bind"!=attr.name)if(attr.name.startsWith("ko-")){var name=attr.name.substr(3);bindings.push(name+":"+attr.value),node.removeAttribute(attr.name)}else attr.value.indexOf("{{")>=0&&process_attr(attr)&&node.removeAttribute(attr.name)}return attrBinding.length&&bindings.push("attr:{"+attrBinding.join(", ")+"}"),bindings}function attrs_has_bindings(node){if(1==node.nodeType&&node.attributes)for(var i=0;i<node.attributes.length;i++){var attr=node.attributes[i];if("data-bind"==attr.name||attr.name.startsWith("ko-")||attr.value.indexOf("{{")>=0)return!0}return!1}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),String.prototype.startsWith||(String.prototype.startsWith=function(prefix){return 0===this.indexOf(prefix)});var expr_map={"#each":"foreach","#if":"if","#unless":"ifnot","#with":"with"};Object.keys(expr_map).forEach(function(key){var keyword=expr_map[key];expr_map[key]=commentFn(keyword,key)}),expr_map["/"]=function(){return document.createComment("/ko")};var bindingMap={value:"value",disabled:"disable",disable:"disable",enabled:"enable",enable:"enable",checked:"checked"},provider=ko.bindingProvider.instance;provider.preprocessNode=function(node){switch(node.nodeType){case 1:return process_attrs(node);case 3:return interpolateMarkup(node)}};var ko_nodeHasBindings=provider.nodeHasBindings;provider.nodeHasBindings=function(node){return ko_nodeHasBindings.call(provider,node)||attrs_has_bindings(node)}}();